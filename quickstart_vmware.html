

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>VMware Module Quick Start Guide &mdash; CSC DCAF 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="CSC DCAF 1.0 documentation" href="index.html"/>
        <link rel="up" title="CSC DCAF Quick Start Guides" href="quickstart.html"/>
        <link rel="next" title="Requirements &amp; Dependencies" href="requirements.html"/>
        <link rel="prev" title="Ansible-ScaleIO Quick Start Guide" href="quickstart_ansible_scaleio.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> CSC DCAF
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="quickstart.html">CSC DCAF Quick Start Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart_autodeploynode.html">Autodeploynode Module Quick Start Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart_bare_metal_os.html">Bare-metal-OS Module Quick Start Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart_rhel_osp.html">RHEL-OSP Module Quick Start Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart_kvm_host.html">KVM-Host Module Quick Start Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart_slimer.html">Slimer Quick Start Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart_ansible_scaleio.html">Ansible-ScaleIO Quick Start Guide</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">VMware Module Quick Start Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#before-you-begin">Before You Begin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#physical-hardware">Physical Hardware</a></li>
<li class="toctree-l4"><a class="reference internal" href="#network-requirements">Network Requirements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-the-vmware-automation">Run the VMware Automation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#create-the-inventory">Create the Inventory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modify-host-project-variables">Modify Host &amp; Project Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-vmware-automation">Run VMware Automation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prepare-hosts-for-deployment">Prepare Hosts for Deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#deploy-vmware-virtual-infrastructure">Deploy VMware Virtual Infrastructure</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements &amp; Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="autodeploynode_module.html">Autodeploynode Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="bare_metal_os_module.html">Bare-Metal-OS Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kvm_host_module.html">KVM-Host Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rhel_osp_module.html">RHEL-OSP Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="vmware_module.html">VMware Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="known_issues.html">Known Issues and Troubleshooting</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">CSC DCAF</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="quickstart.html">CSC DCAF Quick Start Guides</a> &raquo;</li>
      
    <li>VMware Module Quick Start Guide</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/quickstart_vmware.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="vmware-module-quick-start-guide">
<h1>VMware Module Quick Start Guide<a class="headerlink" href="#vmware-module-quick-start-guide" title="Permalink to this headline">¶</a></h1>
<p>This Quick Start Guide describes how to use CSC DCAF Automation to deploy a VMware
virtual infrastructure to bare-metal hardware. It uses the following resources:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/csc/dcaf/vmware">VMware</a> - An automated deployment of
a VMware Virtual Infrastructure on bare-metal hardware.</li>
<li><a class="reference external" href="https://github.com/csc/Hanlon">Hanlon</a> - As an advanced provisioning
platform which can provision both bare-metal and virtual systems.</li>
</ul>
<div class="section" id="before-you-begin">
<h2>Before You Begin<a class="headerlink" href="#before-you-begin" title="Permalink to this headline">¶</a></h2>
<p>Ensure that the following requirements are met:</p>
<ul class="simple">
<li>A user account on the VMware website to download the software.</li>
<li>Download the vSphere 5.5 ISO and VCSA .ova to <code class="docutils literal"><span class="pre">/opt/autodeploy/resources/ISO</span></code>
folder.</li>
<li>OVF Tool installed on the Autodeploynode</li>
<li>vSphere CLI installed on the Autodeploynode</li>
</ul>
<div class="section" id="physical-hardware">
<h3>Physical Hardware<a class="headerlink" href="#physical-hardware" title="Permalink to this headline">¶</a></h3>
<p>DCAF was developed and tested with the following hardware:</p>
<ul class="simple">
<li>DELL PowerEdge 630 | PowerEdge 730</li>
<li>DELL PERC H730 RAID Controller</li>
</ul>
<p>The physical hardware being deployed to meet the following:</p>
<ul class="simple">
<li>The physical hardware has been installed and connected to the network</li>
<li>Hosts to be deployed to have pass-through RAID controllers</li>
<li>The system BIOS has been pre-configured, e.g. VT is enabled, boot order</li>
<li>The out-of-band management IP addresses have been set and IPMI access enabled</li>
</ul>
</div>
<div class="section" id="network-requirements">
<h3>Network Requirements<a class="headerlink" href="#network-requirements" title="Permalink to this headline">¶</a></h3>
<p>There are several network requirements for the deployment.</p>
<ul>
<li><p class="first">DNS server IP addresses need to be provided</p>
</li>
<li><p class="first">NTP server IP address needs to be provided</p>
</li>
<li><dl class="first docutils">
<dt>The following VLANS are required:</dt>
<dd><ul class="first last simple">
<li>Out-of-band management (IPMI)</li>
<li>PXE Network</li>
<li>Management</li>
<li>vMotion</li>
<li>VSAN</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>VMKernel IP addresses for each ESXi host</dt>
<dd><ul class="first last simple">
<li>vmk0 : PXE Network</li>
<li>vmk1 : Management Network</li>
<li>vmk2 : vMotion Network</li>
<li>vmk3 : VSAN Network</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Out-of-band Network IP address for each host</p>
</li>
<li><p class="first">Management IP address for each host and VCSA</p>
</li>
<li><p class="first">2 10GbE connections to the 10GbE network switches</p>
</li>
<li><p class="first">The upstream and management networks are pre-configured</p>
</li>
</ul>
</div>
</div>
<div class="section" id="run-the-vmware-automation">
<h2>Run the VMware Automation<a class="headerlink" href="#run-the-vmware-automation" title="Permalink to this headline">¶</a></h2>
<p>To use the VMware automation create the inventory and variables then run the
playbook(s).</p>
<div class="section" id="create-the-inventory">
<h3>Create the Inventory<a class="headerlink" href="#create-the-inventory" title="Permalink to this headline">¶</a></h3>
<p>The inventory is managed by the <code class="code docutils literal"><span class="pre">hosts.ini</span></code> file. The format and contents of
this file will vary depending on the what automation is being used. For more information
and examples of this file refer to the CSC DCAF project documentation.</p>
<p>Edit the inventory to reflect your environment.</p>
<ul class="simple">
<li><strong>hosts.ini</strong> - Copy the <code class="docutils literal"><span class="pre">/vmware/inventory/host_vars/hosts.ini</span></code> file
to the <code class="docutils literal"><span class="pre">/opt/autodeploy/projects/inventory/</span></code> folder. Edit it to reflect the
number of hosts and correct host names for the deployment. This file should
contain the DNS resolvable names of the hosts being deployed.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">hosts.ini</span></code> will contain <code class="code docutils literal"><span class="pre">[group]</span></code> headings that correspond to
a module or the role the host will have within the module. Each <code class="code docutils literal"><span class="pre">[group]</span></code> name
should match the corresponding <code class="docutils literal"><span class="pre">inventory/group_vars/group_name.yml</span></code> group variable
file if it has one. All hosts listed should be under a <code class="code docutils literal"><span class="pre">[group]</span></code> heading.</p>
</div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Example snippet from the hosts.ini file</span><span class="p p-Indicator">:</span>
<span class="c1"># Host(s) to be deployed - modify as needed</span>
<span class="p p-Indicator">[</span><span class="nv">foundation_esxi</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">foundation-esxi-01</span>
<span class="l l-Scalar l-Scalar-Plain">foundation-esxi-02</span>
<span class="nn">...</span>

<span class="c1"># VCSA to be deployed - modify as needed</span>
<span class="p p-Indicator">[</span><span class="nv">vcsa</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">foundation-vcsa</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Do not modify a group of groups <code class="code docutils literal"><span class="pre">[group:children]</span></code>. These groups are defined
by the module. Add the required hosts in the respective <code class="code docutils literal"><span class="pre">[group]</span></code> section
as needed.</p>
</div>
</div>
<div class="section" id="modify-host-project-variables">
<h3>Modify Host &amp; Project Variables<a class="headerlink" href="#modify-host-project-variables" title="Permalink to this headline">¶</a></h3>
<p>This project uses multiple variables that are managed in various files. The
<code class="docutils literal"><span class="pre">host_vars/host_name.yml</span></code> file contains host specific variables and the
<code class="docutils literal"><span class="pre">group_vars/group_name.yml</span></code> files contain project specific variables.</p>
<ul class="simple">
<li><strong>host_name.yml</strong> - There should be a <code class="docutils literal"><span class="pre">/opt/autodeploy/projects/inventory/host_vars/host_name.yml</span></code>
file for each host, based on VMware role or service, in the hosts.ini file. Copy
them from the <code class="docutils literal"><span class="pre">/vmware/inventory/host_vars</span></code> folder to the <code class="docutils literal"><span class="pre">/opt/autodeploy/projects/inventory/host_vars</span></code>
folder and modify as needed.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Each <code class="docutils literal"><span class="pre">host_name.yml</span></code> file must include the host hardware <code class="code docutils literal"><span class="pre">smbios-uuid</span></code>.
This can be found using the hosts vendor management tools. Refer to the vendor
documentation for more information.</p>
</div>
<ul class="simple">
<li><strong>foundation-esxi.yml</strong> - Copy the <code class="docutils literal"><span class="pre">/vmware/inventory/group_vars/foundation-esxi.yml</span></code>
file to the <code class="docutils literal"><span class="pre">/opt/autodeploy/projects/inventory/group_vars/</span></code> folder and modify
as needed per the environment.</li>
<li><strong>/group_vars/all/</strong> <code class="docutils literal"><span class="pre">.yml</span></code> files - Copy the <code class="docutils literal"><span class="pre">/vmware/inventory/group_vars/all</span></code>
folder and its contents to the <code class="docutils literal"><span class="pre">/opt/autodeploy/projects/inventory/group_vars</span></code>
folder. Review all variables and change as needed.</li>
</ul>
</div>
</div>
<div class="section" id="run-vmware-automation">
<h2>Run VMware Automation<a class="headerlink" href="#run-vmware-automation" title="Permalink to this headline">¶</a></h2>
<p>Now that the inventory has been created the VMware automation can be used.</p>
<div class="section" id="prepare-hosts-for-deployment">
<h3>Prepare Hosts for Deployment<a class="headerlink" href="#prepare-hosts-for-deployment" title="Permalink to this headline">¶</a></h3>
<p>In order for Hanlon to deploy anything to a host the host has to be <cite>discovered</cite>
by Hanlon. The discovery process provides Hanlon information about the host.</p>
<p>To have the hosts <cite>discovered</cite> by Hanlon simply boot each host. The host will PXE
boot to Hanlon, register itself and power off.</p>
</div>
<div class="section" id="deploy-vmware-virtual-infrastructure">
<h3>Deploy VMware Virtual Infrastructure<a class="headerlink" href="#deploy-vmware-virtual-infrastructure" title="Permalink to this headline">¶</a></h3>
<p>Next run the <code class="docutils literal"><span class="pre">/vmware/site_deploy.yml</span></code> playbook to deploy the vSphere to the
hosts in inventory:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">cd</span> /opt/autodeploy/projects/dcaf/modules/vmware
ansible-playbook site_deploy.yml -i ../../inventory/hosts.ini
</pre></div>
</div>
<p>At this point the VMware virtual infrastructure and foundation cluster have been
installed and configured on all hosts listed in the <code class="docutils literal"><span class="pre">/opt/autodeploy/projects/inventory/hosts.ini</span></code>.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="requirements.html" class="btn btn-neutral float-right" title="Requirements &amp; Dependencies" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="quickstart_ansible_scaleio.html" class="btn btn-neutral" title="Ansible-ScaleIO Quick Start Guide" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, CSC.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>